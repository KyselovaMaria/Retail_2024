# Серверний додаток API

## Огляд

Цей додаток надає REST API для управління різними аспектами системи.

## Роути

### /order

#### GET /

Отримати список всіх замовлень.

#### GET /:id

Отримати конкретне замовлення за його ідентифікатором.

#### POST /

Створити нове замовлення з наданими даними в тілі запиту.

Приклад JSON-об'єкту для створення нового замовлення:
```json
{
  warehouseId: string;
  shippingAddress: string;
}
```

#### POST /confirm/:id

Підтвердження замовлення, необхідно мати роль менеджер чи адмін

### /warehouse

#### GET /

Отримати список всіх складів.

#### GET /:id

Отримати конкретний склад за його ідентифікатором.

#### GET /withProduct/:id

Отримати склади з певним товаром в них.

#### POST /

Створити новий склад з наданими даними в тілі запиту.

Приклад JSON-об'єкту для створення нового складу:
```json
{
  name: string;
  address: string;
}
```

Приклад HTTP-header:
```json
{
  Authorization: Bearer {token}
}
```

### /product

#### GET /

Отримати список всіх продуктів.

#### GET /:id

Отримати конкретний продукт за його ідентифікатором.

#### POST /

Створити новий продукт з наданими даними в тілі запиту.

Приклад JSON-об'єкту для створення нового продукта:
```json
{
  name: string;
  price: number;
  minimumStock: number;
}
```

Приклад HTTP-header:
```json
{
  Authorization: Bearer {token}
}
```

### /stock

#### POST /addToStock

Додати кількість товару до стоку.

Приклад JSON-об'єкту для створення нового продукта:
```json
{
  id: string;
  amount: number;
}
```

Приклад HTTP-header:
```json
{
  Authorization: Bearer {token}
}
```

#### POST /transferStock

Перенести товар з одного стоку на інший.

Приклад JSON-об'єкту для створення нового продукта:
```json
{
  stockToId: string;
  stockFromId: string;
  amount: number;
}
```

Приклад HTTP-header:
```json
{
  Authorization: Bearer {token}
}
```

#### POST /

Створити новий продукт з наданими даними в тілі запиту.

Приклад JSON-об'єкту для створення нового продукта:
```json
{
  productId: string;
  warehouseId: string;
  amount: number;
}
```

Приклад HTTP-header:
```json
{
  Authorization: Bearer {token}
}
```


### /orderListing

#### POST /

Додати кількість товару до стоку.

Приклад JSON-об'єкту для створення нового продукта:
```json
{
  orderId: string;
  productId: string;
  amount: number;
}
```


### /auth

#### POST /login

Отримати новий токен через логін.

Приклад JSON-об'єкту:
```json
{
  username: string
  password: string
}
```

#### POST /signup

Створити нового юзера з роллю. roleId: 1 - admin, 2 - manager, 3 customer

Приклад JSON-об'єкту для створення нового юзера:
```json
{
  username: string,
  email: string,
  password: string,
  roleId: number,
}
```

### /user

#### GET /

Отримати дані про користувача з токена, для перевірки авторизації в основному.

### /report

#### GET /:warehouseId

Запит для загрузки репорту для конкретного складу, якщо зробити запит в браузері - автоматично встановлює цей файл

### /roles

#### GET /

Отримати існуючі ролі.

#### Admin

Може все, тільки адмін може створювати нові продукти, склади, редагувати та видаляти їх

#### MANAGER

Може те, що може кастомер. Також може редагувати, додавати і т.п. stocks

#### CUSTOMER

Може все окрім того, що унікально для менеджерів і адмінів

## Розгортання серверу

### Клонування з репозиторію

Спочатку треба клонувати віддалений репозиторій за допомогою команди git clone <посилання на репозиторій>.

### Конфігурація проекту

Треба налаштувати файл змінних середовища .env таким чином, щоб там були поля RETAIL_DB_CONN_URI та SECRET_AUTH_KEY для з'єднання з базою даних та створення токенів відповідно.

### Встановлення Node.js та бібліотек

Спочатку треба встановити Node.js v18.16.1 та встановити pnpm через команду npm install -g pnpm. Після цього встановлюємо необхідні бібліотеки за допомогою команди pnpm install.

### Запуск серверу

Запускаємо сервер командою pnpm run start, яка білдить і запускає застосунок на порті 3000. Таким чином ми маємо працюючий сервер за адресою localhost:3000.